!function(){"use strict";class t{constructor(){}static init(){Laya.ClassUtils.regClass}}t.width=750,t.height=1334,t.scaleMode="fixedauto",t.screenMode="none",t.alignV="top",t.alignH="left",t.startScene="view/ad/FailedOver.scene",t.sceneRoot="",t.debug=!1,t.stat=!1,t.physicsDebug=!1,t.exportSceneToJson=!0,t.init();class e{static get SOUND_CLICK(){return fc.framework.GameFrame.appConfig.soundClick}}e.CONFIG_LEVEL_CONFIG="config/levelCfgs.json",e.SPRITE3D_BLOCK="block.lh",e.SPRITE3D_GOLD="gold.lh",e.MATERIAL_BLOCK="Assets/Materials/block.lmat",e.MATERIAL_BLOCK_BLACK="Assets/Materials/block_black.lmat",e.MATERIAL_BLOCK_LIGHT="Assets/Materials/block_light.lmat",e.ANIMATOR_CAMERA_IN_HOME="camera_in_home",e.ANIMATOR_CAMERA_TO_GAME="camera_to_game",e.ANIMATOR_CAMERA_TO_SUCCESS="camera_to_success",e.ANIMATOR_CAMERA_TO_FAILED="camera_to_failed",e.ANIMATOR_PLAYER_IDLE="idle",e.ANIMATAR_PLAYER_RUN="rush",e.ANIMATOR_PLAYER_RUSH="acc",e.ANIMATOR_PLAYER_SUCCESS="win",e.ANIMATOR_PLAYER_FAILED="fail",e.ANIMATOR_PLAYER_FLY="showForward",e.ANIMATOR_PLAYER_LAND="fly";class s{}var i;s.LEVEL_COUNT=6,s.PLAYER_FLY_SPEED=10,s.PLAYER_RUN_SPEED=5,s.PLAYER_RUSH_SPEED=8,s.PLAYER_JUMP_SPEED=10,s.PLAYER_FALL_SPEED=8,s.PLAYER_RUN_ROTATE_SPEED=.5,s.PLAYER_RUSH_ROTATE_SPEED=-8,s.PLAYER_STARTUP_DUARATION=1e3,s.PLAYER_ACCELERATE_DUARATION=1e3,s.PLAYER_DECELERATE_DUARATION=1e3,s.BLOCK_TYPE_NODE="block",s.BLOCK_TYPE_POINT="point",s.BLOCK_TYPE_TRIGGER_BREAK="breakSpot",s.BLOCK_TYPE_TRIGGER_LAND="landSpot",function(t){t[t.scene=0]="scene",t[t.gold=1]="gold",t[t.trigger_break=2]="trigger_break",t[t.trigger_land=3]="trigger_land",t[t.trigger_ai=4]="trigger_ai",t[t.none=5]="none"}(i||(i={}));var o=fc.plugin.ObjectPool;class a extends Laya.Script3D{constructor(){super(...arguments),this.mPrefab=null,this.mBuildingMesh=null}static create(t){var e=o.getEmptySprite3d("building"),s=e.getComponent(a);return null==s&&(s=e.addComponent(a)),s.reset(t),e}static recover(t){var e=t.getComponent(a);e&&e.clear(),o.recoverSprite3d(t)}reset(t){t!=this.mPrefab&&null!=t&&(this.mPrefab=t,fc.framework.Resource.loadSprite3dAsyn(this.mPrefab,Laya.Handler.create(this,this.onBuildingReady,[t]),null,null))}clear(){this.mBuildingMesh&&o.recoverSprite3d(this.mBuildingMesh),this.mBuildingMesh=null}onBuildingReady(t,e){t==this.mPrefab&&(this.mBuildingMesh&&o.recoverSprite3d(this.mBuildingMesh),this.mBuildingMesh=o.getSprite3d(e,t),this.owner.addChild(this.mBuildingMesh),this.mBuildingMesh.transform.localPosition.setValue(0,0,0),this.mBuildingMesh.transform.localPosition=this.mBuildingMesh.transform.localPosition,this.mBuildingMesh.transform.localRotation.identity(),this.mBuildingMesh.transform.localRotation=this.mBuildingMesh.transform.localRotation,this.mBuildingMesh.transform.localScale.setValue(1,1,1),this.mBuildingMesh.transform.localScale=this.mBuildingMesh.transform.localScale)}onAwake(){}}class n{}n.SHOW_SUCCESS="SHOW_SUCCESS",n.SHOW_FAILED="SHOW_FAILED",n.REACH_NEW_NODE="REACH_NEW_NODE";var r,l,h=fc.plugin.ObjectPool,m=fc.framework.Resource;class d extends Laya.Script3D{constructor(){super(...arguments),this.mBlockMesh=null,this.mGoldMesh=null,this.mActive=!1,this.mGoldVisible=!1,this.mBlockMatIdex=0}static create(t,e,s){var i=h.getEmptySprite3d("slot");s.addChild(i);var o=i.getComponent(d);return null==o&&(o=i.addComponent(d)),o.reset(t,e),i}static recover(t){var e=t.getComponent(d);e&&e.clear(),h.recoverSprite3d(t)}reset(t,o){this.mActive=!0,this.mObjType=o,this.mGoldVisible=!1,this.mBlockMatIdex=0,t&&m.load3dResAsyn(m.get3dResUrl(e.SPRITE3D_BLOCK),Laya.Handler.create(this,this.onBlockReady),null,null),o==i.gold&&(this.mGoldVisible=!0,m.load3dResAsyn(m.get3dResUrl(e.SPRITE3D_GOLD),Laya.Handler.create(this,this.onGoldReady),null,null)),o==i.trigger_land?this.owner.name=s.BLOCK_TYPE_TRIGGER_LAND:o==i.trigger_break?this.owner.name=s.BLOCK_TYPE_TRIGGER_BREAK:this.owner.name=s.BLOCK_TYPE_NODE}clear(){this.mActive=!1,this.mGoldMesh&&h.recoverSprite3d(this.mGoldMesh),this.mGoldMesh=null,this.mBlockMesh&&h.recoverSprite3d(this.mBlockMesh),this.mBlockMesh=null}onBlockReady(t){0!=this.mActive&&(this.mBlockMesh=h.getSprite3d(t,"block"),this.owner.addChild(this.mBlockMesh),this.mBlockMesh.transform.localPosition.setValue(0,0,0),this.mBlockMesh.transform.localPosition=this.mBlockMesh.transform.localPosition,this.mBlockMesh.transform.localRotation.identity(),this.mBlockMesh.transform.localRotation=this.mBlockMesh.transform.localRotation,this.mBlockMesh.transform.localScale.setValue(1,1,1),this.mBlockMesh.transform.localScale=this.mBlockMesh.transform.localScale,0==this.mBlockMatIdex?this.mBlockMesh.meshRenderer.sharedMaterial=Laya.loader.getRes(m.get3dResUrl(e.MATERIAL_BLOCK)):1==this.mBlockMatIdex?this.mBlockMesh.meshRenderer.sharedMaterial=Laya.loader.getRes(m.get3dResUrl(e.MATERIAL_BLOCK_LIGHT)):this.mBlockMesh.meshRenderer.sharedMaterial=Laya.loader.getRes(m.get3dResUrl(e.MATERIAL_BLOCK)))}onGoldReady(t){0!=this.mActive&&0!=this.mGoldVisible&&(this.mGoldMesh=h.getSprite3d(t,"gold"),this.owner.addChild(this.mGoldMesh),this.mGoldMesh.transform.localPosition.setValue(0,1,0),this.mGoldMesh.transform.localPosition=this.mGoldMesh.transform.localPosition,this.mGoldMesh.transform.localRotation.identity(),this.mGoldMesh.transform.localRotation=this.mGoldMesh.transform.localRotation,this.mGoldMesh.transform.localScale.setValue(1,1,1),this.mGoldMesh.transform.localScale=this.mGoldMesh.transform.localScale)}onAwake(){this.owner.name="block"}onEnable(){this.owner.on(n.REACH_NEW_NODE,this,this.onPlayerReached)}onDisable(){this.owner.off(n.REACH_NEW_NODE,this,this.onPlayerReached)}onPlayerReached(t){this.mObjType==i.gold&&(this.mGoldMesh&&h.recoverSprite3d(this.mGoldMesh),this.mGoldMesh=null,this.mGoldVisible=!1),t&&(this.mBlockMatIdex=1,this.mBlockMesh&&(this.mBlockMesh.meshRenderer.sharedMaterial=Laya.loader.getRes(m.get3dResUrl(e.MATERIAL_BLOCK_LIGHT))))}}!function(t){t[t.objVisible=0]="objVisible",t[t.itemType=1]="itemType",t[t.prefabIdx=2]="prefabIdx",t[t.positionX=3]="positionX",t[t.positionY=4]="positionY",t[t.positionZ=5]="positionZ",t[t.rotationX=6]="rotationX",t[t.rotationY=7]="rotationY",t[t.rotationZ=8]="rotationZ",t[t.rotationW=9]="rotationW",t[t.attributeCount=10]="attributeCount"}(r||(r={}));class c{static get objCount(){return this.levelData.objInfos.length/this.valNum}static get itemType(){return this.levelData.objInfos[this.objIdx*this.valNum+r.itemType]}static get objVisible(){return this.levelData.objInfos[this.objIdx*this.valNum+r.objVisible]}static get objPrefab(){return this.levelData.prefabs[this.levelData.objInfos[this.objIdx*this.valNum+r.prefabIdx]]}static get positionX(){return.01*this.levelData.objInfos[this.objIdx*this.valNum+r.positionX]}static get positionY(){return.01*this.levelData.objInfos[this.objIdx*this.valNum+r.positionY]}static get positionZ(){return.01*this.levelData.objInfos[this.objIdx*this.valNum+r.positionZ]}static get rotationX(){return.01*this.levelData.objInfos[this.objIdx*this.valNum+r.rotationX]}static get rotationY(){return.01*this.levelData.objInfos[this.objIdx*this.valNum+r.rotationY]}static get rotationZ(){return.01*this.levelData.objInfos[this.objIdx*this.valNum+r.rotationZ]}static get rotationW(){return.01*this.levelData.objInfos[this.objIdx*this.valNum+r.rotationW]}}c.valNum=r.attributeCount;class S extends Laya.Script3D{get PathRoot(){return this.mPathRoot}reset(){for(;this.mPathRoot.numChildren;)d.recover(this.mPathRoot.getChildAt(0));for(;this.mSceneRoot.numChildren;)a.recover(this.mSceneRoot.getChildAt(0));var t=this.mLevCfgs.levelDatas.length-2,e=[];e.push(0);for(var o=0;o<s.LEVEL_COUNT;o++)e.push(Math.floor(Math.random()*t)+1);e.push(this.mLevCfgs.levelDatas.length-1);var n,r=0,l=0;for(o=0;o<e.length;o++){c.levelData=this.mLevCfgs.levelDatas[e[o]];const t=c.objCount;for(c.objIdx=0;c.objIdx<t;c.objIdx++)c.itemType==i.scene?(n=a.create(c.objPrefab),this.mSceneRoot.addChild(n)):(l=c.positionZ,n=d.create(1==c.objVisible,c.itemType,this.mPathRoot)),n.transform.localPosition.setValue(c.positionX,c.positionY,c.positionZ+r),n.transform.localPosition=n.transform.localPosition,n.transform.localRotation.x=c.rotationX,n.transform.localRotation.y=c.rotationY,n.transform.localRotation.z=c.rotationZ,n.transform.localRotation.w=c.rotationW,n.transform.localRotation=n.transform.localRotation;r+=l}this.mRoad.transform.localScaleZ=r+20,this.mRoad.transform.localPositionZ=.5*r-20}onAwake(){this.mSprite3d=this.owner,this.mLevCfgs=Laya.loader.getRes(e.CONFIG_LEVEL_CONFIG),this.mRoad=this.mSprite3d.getChildByName("road"),this.mPathRoot=this.mSprite3d.addChild(new Laya.Sprite3D("pathRoot")),this.mPathRoot.transform.localPosition.setValue(0,0,0),this.mPathRoot.transform.localPosition=this.mPathRoot.transform.localPosition,this.mPathRoot.transform.localRotation.identity(),this.mPathRoot.transform.localRotation=this.mPathRoot.transform.localRotation,this.mPathRoot.transform.localScale.setValue(1,1,1),this.mPathRoot.transform.localScale=this.mPathRoot.transform.localScale,this.mSceneRoot=this.mSprite3d.addChild(new Laya.Sprite3D("sceneRoot")),this.mSceneRoot.transform.localPosition.setValue(0,0,0),this.mSceneRoot.transform.localPosition=this.mSceneRoot.transform.localPosition,this.mSceneRoot.transform.localRotation.identity(),this.mSceneRoot.transform.localRotation=this.mSceneRoot.transform.localRotation,this.mSceneRoot.transform.localScale.setValue(1,1,1),this.mSceneRoot.transform.localScale=this.mSceneRoot.transform.localScale}initSceneItem(t){}initPathNode(t){}}!function(t){t[t.idle=0]="idle",t[t.follow=1]="follow",t[t.fly=2]="fly",t[t.fall=3]="fall",t[t.dead=4]="dead"}(l||(l={}));class R extends Laya.Script3D{constructor(){super(...arguments),this.mSrcNodeIdx=0,this.mDstNodeIdx=0,this.mSrcPosition=new Laya.Vector3,this.mDstPosition=new Laya.Vector3,this.mSrcRotation=new Laya.Quaternion,this.mDstRotation=new Laya.Quaternion,this.mCurPosition=new Laya.Vector3,this.mCurRotation=new Laya.Quaternion,this.mRotateInSky=new Laya.Quaternion}get Position(){return this.mSprite3d.transform.localPosition}reset(t){t!=this.mModelId&&null!=t&&this.loadModel(t),this.mSrcPosition.setValue(0,0,0),this.mDstPosition.setValue(0,0,0),this.mSrcRotation.identity(),this.mDstRotation.identity(),this.mCurPosition.setValue(0,0,0),this.mCurRotation.identity(),this.mCurState=l.idle,this.mNewState=l.idle,this.mSrc2DstDist=1,this.mCurPassedDist=0,this.mFlySpeed=s.PLAYER_FLY_SPEED,this.mRunSpeed=s.PLAYER_RUN_SPEED,this.mRushSpeed=s.PLAYER_RUSH_SPEED,this.mCurZSpeed=0,this.mFallSpeed=s.PLAYER_FALL_SPEED,this.mCurYSpeed=0,this.mRunRotateSpeed=s.PLAYER_RUN_ROTATE_SPEED,this.mRushRotateSpeed=s.PLAYER_RUSH_ROTATE_SPEED,this.mStartUpPassed=0,this.mStartUpDuaration=s.PLAYER_STARTUP_DUARATION,this.mAcceleratePassed=0,this.mAccelerateDuaration=s.PLAYER_ACCELERATE_DUARATION,this.mDeceleratePassed=0,this.mDecelerateDuaration=s.PLAYER_DECELERATE_DUARATION,this.mIsInRush=!1,this.mHeightInSky=0,this.mRotateInSky.identity(),this.playAnim(e.ANIMATOR_PLAYER_IDLE),this.mCurPosition.cloneTo(this.mSprite3d.transform.localPosition),this.mSprite3d.transform.localPosition=this.mSprite3d.transform.localPosition,this.mCurRotation.cloneTo(this.mSprite3d.transform.localRotation),this.mSprite3d.transform.localRotation=this.mSprite3d.transform.localRotation}toStart(t){this.mSrcNodeIdx=0,this.mDstNodeIdx=1,this.mNewState=this.mCurState=l.follow;var e=t.getChildAt(this.mSrcNodeIdx),s=t.getChildAt(this.mDstNodeIdx);e.transform.localPosition.cloneTo(this.mSrcPosition),e.transform.localRotation.cloneTo(this.mSrcRotation),s.transform.localPosition.cloneTo(this.mDstPosition),s.transform.localRotation.cloneTo(this.mDstRotation),this.mSrc2DstDist=Math.pow(this.mDstPosition.y-this.mSrcPosition.y,2)+Math.pow(this.mDstPosition.z-this.mSrcPosition.z,2),this.mSrc2DstDist=Math.sqrt(this.mSrc2DstDist),this.mCurPassedDist=0}updatePosition(t){if(this.mDstNodeIdx!=t.numChildren){for(this.mCurState==l.follow&&(this.mStartUpPassed<this.mStartUpDuaration?(this.mStartUpPassed+=Laya.timer.delta,this.mStartUpPassed>=this.mStartUpDuaration?this.mCurZSpeed=this.mRunSpeed:this.mCurZSpeed=Laya.MathUtil.lerp(0,this.mRunSpeed,this.mStartUpPassed/this.mStartUpDuaration)):this.mIsInRush?this.mAcceleratePassed<this.mAccelerateDuaration&&(this.mAcceleratePassed+=Laya.timer.delta,this.mAcceleratePassed>=this.mAccelerateDuaration?this.mCurZSpeed=this.mRushSpeed:this.mCurZSpeed=Laya.MathUtil.lerp(this.mRunSpeed,this.mRushSpeed,this.mAcceleratePassed/this.mAccelerateDuaration)):this.mDeceleratePassed<this.mDecelerateDuaration&&(this.mDeceleratePassed+=Laya.timer.delta,this.mDeceleratePassed>=this.mDecelerateDuaration?this.mCurZSpeed=this.mRunSpeed:this.mCurZSpeed=Laya.MathUtil.lerp(this.mRushSpeed,this.mRunSpeed,this.mDeceleratePassed/this.mDecelerateDuaration))),this.mCurPassedDist+=this.mCurZSpeed*Laya.timer.delta*.001;this.mCurPassedDist>this.mSrc2DstDist;){if(this.mCurPassedDist-=this.mSrc2DstDist,this.mSrcNodeIdx++,this.mDstNodeIdx++,this.mDstNodeIdx==t.numChildren)return this.mDstPosition.cloneTo(this.mSprite3d.transform.localPosition),this.mSprite3d.transform.localPosition=this.mSprite3d.transform.localPosition,this.mDstRotation.cloneTo(this.mSprite3d.transform.localRotation),this.mSprite3d.transform.localRotation=this.mSprite3d.transform.localRotation,this.mNewState=l.idle,void this.onReachDst();this.mDstPosition.cloneTo(this.mSrcPosition),this.mDstRotation.cloneTo(this.mSrcRotation);var e=t.getChildAt(this.mDstNodeIdx);e.transform.localPosition.cloneTo(this.mDstPosition),e.transform.localRotation.cloneTo(this.mDstRotation),this.mSrc2DstDist=Math.pow(this.mDstPosition.y-this.mSrcPosition.y,2)+Math.pow(this.mDstPosition.z-this.mSrcPosition.z,2),this.mSrc2DstDist=Math.sqrt(this.mSrc2DstDist);var i=t.getChildAt(this.mSrcNodeIdx);i.name==s.BLOCK_TYPE_TRIGGER_BREAK?(this.mIsInRush?(this.mNewState=l.fly,this.mCurZSpeed=this.mFlySpeed):(this.mNewState=l.fall,this.mCurYSpeed=0,this.mCurZSpeed=this.mRunSpeed,this.mHeightInSky=this.mSrcPosition.y),this.mSrcRotation.cloneTo(this.mRotateInSky)):this.mNewState==l.fly&&i.name==s.BLOCK_TYPE_TRIGGER_LAND&&(this.mNewState=l.follow),this.onReachNewNode(i)}if(this.mCurState==l.fly?this.mIsInRush&&this.mRotateInSky.rotateX(.001*Laya.timer.delta*this.mRushRotateSpeed,this.mRotateInSky):this.mCurState==l.fall&&(this.mCurYSpeed-=this.mFallSpeed*Laya.timer.delta*.001,this.mRotateInSky.rotateX(.001*Laya.timer.delta*this.mRunRotateSpeed,this.mRotateInSky)),Laya.Vector3.lerp(this.mSrcPosition,this.mDstPosition,this.mCurPassedDist/this.mSrc2DstDist,this.mCurPosition),Laya.Quaternion.lerp(this.mSrcRotation,this.mDstRotation,this.mCurPassedDist/this.mSrc2DstDist,this.mCurRotation),this.mCurState==l.fly)if(this.mNewState==l.follow){this.mCurZSpeed=this.mRushSpeed;var o=new Laya.Vector3,a=new Laya.Vector3;this.mCurRotation.getYawPitchRoll(o),this.mRotateInSky.getYawPitchRoll(a),Math.cos(o.y)*Math.cos(a.y)+Math.sin(o.y)*Math.sin(a.y)<.1&&(this.mNewState=l.dead,this.mRotateInSky.cloneTo(this.mCurRotation),this.onDead())}else this.mRotateInSky.cloneTo(this.mCurRotation);else this.mCurState==l.fall&&(this.mHeightInSky+=this.mCurYSpeed*Laya.timer.delta*.001,this.mHeightInSky<=-11?(this.mNewState=l.dead,this.onDead(),this.mCurRotation.identity(),this.mCurPosition.y=-11):(this.mCurPosition.y=this.mHeightInSky,this.mRotateInSky.cloneTo(this.mCurRotation)));this.mCurState=this.mNewState,this.mCurPosition.cloneTo(this.mSprite3d.transform.localPosition),this.mSprite3d.transform.localPosition=this.mSprite3d.transform.localPosition,this.mCurRotation.cloneTo(this.mSprite3d.transform.localRotation),this.mSprite3d.transform.localRotation=this.mSprite3d.transform.localRotation}}playAnim(t){this.mCurAnimState=t,this.mAnimator&&this.mAnimator.play(this.mCurAnimState)}onAwake(){this.mSprite3d=this.owner,this.mAnimator=null,this.mPlayerModel=null}onEnable(){Laya.stage.on(Laya.Event.MOUSE_DOWN,this,this.onStartRush),Laya.stage.on(Laya.Event.MOUSE_OUT,this,this.onStopRush),Laya.stage.on(Laya.Event.MOUSE_UP,this,this.onStopRush)}onDisable(){Laya.stage.off(Laya.Event.MOUSE_DOWN,this,this.onStartRush),Laya.stage.off(Laya.Event.MOUSE_OUT,this,this.onStopRush),Laya.stage.off(Laya.Event.MOUSE_UP,this,this.onStopRush)}loadModel(t){this.mModelId=t,fc.framework.Resource.loadSprite3dAsyn(this.mModelId,Laya.Handler.create(this,this.onModelReady,[t]),null,null)}onModelReady(t,e){t==this.mModelId&&(this.mPlayerModel&&fc.plugin.ObjectPool.recoverSprite3d(this.mPlayerModel),this.mPlayerModel=fc.plugin.ObjectPool.getSprite3d(e,t),this.mSprite3d.addChild(this.mPlayerModel),this.mPlayerModel.transform.localPosition.setValue(0,0,0),this.mPlayerModel.transform.localPosition=this.mPlayerModel.transform.localPosition,this.mPlayerModel.transform.localRotation.identity(),this.mPlayerModel.transform.localRotation=this.mPlayerModel.transform.localRotation,this.mPlayerModel.transform.localScale.setValue(1,1,1),this.mPlayerModel.transform.localScale=this.mPlayerModel.transform.localScale,this.mAnimator=this.mPlayerModel.getComponent(Laya.Animator),this.mAnimator&&this.mAnimator.play(this.mCurAnimState))}onStartRush(){this.mIsInRush=!0,this.mStartUpPassed<=this.mStartUpDuaration?this.mAcceleratePassed=0:this.mAcceleratePassed=this.mAccelerateDuaration*(this.mCurZSpeed-this.mRunSpeed)/(this.mRushSpeed-this.mRunSpeed)}onStopRush(){this.mIsInRush=!1,this.mStartUpPassed>this.mStartUpDuaration&&(this.mDeceleratePassed=this.mDecelerateDuaration*(this.mRushSpeed-this.mCurZSpeed)/(this.mRushSpeed-this.mRunSpeed))}onDead(){Laya.stage.event(n.SHOW_FAILED)}onReachDst(){Laya.stage.event(n.SHOW_SUCCESS)}onReachNewNode(t){t.event(n.REACH_NEW_NODE,this.mIsInRush)}}class u extends Laya.Script3D{reset(){this.mSprite3d.transform.localPosition.setValue(0,0,0),this.mSprite3d.transform.localPosition=this.mSprite3d.transform.localPosition,this.mAnimator.play(e.ANIMATOR_CAMERA_IN_HOME)}toStart(){this.mAnimator.play(e.ANIMATOR_CAMERA_TO_GAME)}showFailed(){this.mAnimator.play(e.ANIMATOR_CAMERA_TO_FAILED)}showSuccess(){this.mAnimator.play(e.ANIMATOR_CAMERA_TO_SUCCESS)}updatePosition(t){this.mSprite3d.transform.localPosition.setValue(t.x,t.y,t.z),this.mSprite3d.transform.localPosition=this.mSprite3d.transform.localPosition}onAwake(){this.mSprite3d=this.owner,this.mAnimator=this.owner.getChildByName("Main Camera").getComponent(Laya.Animator),fc.plugin.AnimStateListener.init(this.mAnimator,e.ANIMATOR_CAMERA_TO_SUCCESS,this),fc.plugin.AnimStateListener.init(this.mAnimator,e.ANIMATOR_CAMERA_TO_FAILED,this)}onAnimStateEnter(t,e){}onAnimStateUpdate(t,e){}onAnimStateExit(t,s){t==e.ANIMATOR_CAMERA_TO_SUCCESS?fc.framework.GameFrame.showSuccessed(null,null):t==e.ANIMATOR_CAMERA_TO_FAILED&&fc.framework.GameFrame.showFailed(null,null)}}var A=fc.define.Event,p=fc.framework.GameFrame;class P extends Laya.Script{constructor(){super()}onAwake(){this.mInitialize=!1,Laya.stage.once(A.LAUNCH_COMPLETED,this,this.onGameLaunchReady),Laya.stage.on(A.GAME_HOME,this,this.onGameHome),Laya.stage.on(A.GAME_START,this,this.onGameStart),Laya.stage.on(A.GAME_OVER,this,this.onGameOver),Laya.stage.on(A.UI_VIEW_OPENED,this,this.onViewOpened),Laya.stage.on(A.UI_VIEW_CLOSED,this,this.onViewClosed),Laya.stage.on(n.SHOW_SUCCESS,this,this.onGameSuccess),Laya.stage.on(n.SHOW_FAILED,this,this.onGameFailed)}onDestroy(){}onUpdate(){0==this.mInitialize||this.mOnGameShow||p.gameState!=fc.define.GameState.STATE_PLAYING||(this.mPlayer.updatePosition(this.mLevManager.PathRoot),this.mCamera.updatePosition(this.mPlayer.Position))}onGameLaunchReady(){console.log("GameLogic",A.LAUNCH_COMPLETED),this.mCamera=p.scene3d.getChildByName("cameraRoot").addComponent(u);var t=p.scene3d.getChildByName("playerRoot");this.mPlayer=t.getChildByName("mainRole").addComponent(R),this.mLevManager=p.scene3d.getChildByName("roadRoot").addComponent(S),this.mInitialize=!0}onGameHome(){this.mPlayer.reset("player_00"),this.mLevManager.reset(),this.mCamera.reset(),this.mOnGameShow=!1}onGameStart(){this.mCamera.toStart(),this.mPlayer.toStart(this.mLevManager.PathRoot)}onGameOver(){}onGameSuccess(){this.mOnGameShow=!0,this.mCamera.showSuccess()}onGameFailed(){this.mOnGameShow=!0,this.mCamera.showFailed()}onViewClosed(t,e){console.log("onViewClosed",t)}onViewOpened(t,e){console.log("onViewOpened",t)}}var L=fc.framework.GameFrame;new class{constructor(){window.Laya3D?Laya3D.init(t.width,t.height):Laya.init(t.width,t.height,Laya.WebGL),Laya.Physics&&Laya.Physics.enable(),Laya.DebugPanel&&Laya.DebugPanel.enable(),Laya.stage.bgColor="#ffffff",Laya.stage.scaleMode=t.scaleMode,Laya.stage.screenMode=t.screenMode,Laya.URL.exportSceneToJson=t.exportSceneToJson,(t.debug||"true"==Laya.Utils.getQueryString("debug"))&&Laya.enableDebugPanel(),t.physicsDebug&&Laya.PhysicsDebugDraw&&Laya.PhysicsDebugDraw.enable(),t.stat&&Laya.Stat.show(),Laya.ResourceVersion.enable("version.json",Laya.Handler.create(this,this.onVersionLoaded),Laya.ResourceVersion.FILENAME_VERSION)}onVersionLoaded(){Laya.AtlasInfoManager.enable("fileconfig.json",Laya.Handler.create(this,this.onConfigLoaded))}onConfigLoaded(){L.appConfig.default3DScene="game-scene",L.appConfig.configList.push(e.CONFIG_LEVEL_CONFIG),L.appConfig.baseResList.push(e.SPRITE3D_BLOCK),L.appConfig.baseResList.push(e.SPRITE3D_GOLD),L.appConfig.baseResList.push(e.MATERIAL_BLOCK_BLACK),L.appConfig.baseResList.push(e.MATERIAL_BLOCK_LIGHT),L.startUp(),Laya.stage.addComponent(P)}}}();