window.zsSdk=function(){function zsSdk(){}return zsSdk.rewardedVideoAd=null,zsSdk.videoCompletedHandler=null,zsSdk.videoInterruptHandler=null,zsSdk.videoErrorHandler=null,zsSdk.fullScreenAD=null,zsSdk.fullScreenADUnitId=null,zsSdk.userInfoButton=null,zsSdk.audioArr=[],zsSdk.srcIdxObj={},zsSdk.init=function(){wx.showShareMenu({withShareTicket:!0}),window.zsResUrl&&(Laya.URL.basePath=window.zsResUrl,Laya.MiniAdpter.nativefiles=window.zsNativefiles),Laya.MiniAdpter.getUrlEncode=function(e,n){return-1!=e.indexOf(".fnt")||-1!=e.indexOf(".json")?"utf8":"arraybuffer"==n?"":"ascii"},console.log("zsSdk.init")},this.loginNum=0,zsSdk.login=function(e,n){this.loginSuccess=e,this.loginFailed=n,this.loginNum++,wx.login({success:function(i){i.code?e&&e.runWith({identityId:i.code}):this.loginNum<=3?this.login(this.loginSuccess,this.loginFailed):n&&n.runWith({code:2,desc:"Code不存在"})},fail:function(){this.loginNum<=3?this.login(this.loginSuccess,this.loginFailed):n&&n.runWith({code:2,desc:"login platform error"})},complete:function(){}})},zsSdk.loadSubpackage=function(e,n,i,t){var o=wx.loadSubpackage({name:e,success(e){i&&i.runWith(1)},fail(e){t&&t.runWith(1)}});return!!o&&(n&&o.onProgressUpdate(function(e){n.runWith(e.progress)}),!0)},zsSdk.createUserInfoButton=function(e,n){var i=wx.getSystemInfoSync();this.userInfoButton=wx.createUserInfoButton({type:"image",text:"",style:{left:i.windowWidth*e.x,top:i.windowHeight*e.y,width:i.windowWidth*e.width,height:i.windowHeight*e.height,opacity:1}});this.userInfoButton.onTap(function(e){console.log("userInfoButtonOnTap:"+e),n&&n.runWith(e)})},zsSdk.showUserInfoButton=function(){this.userInfoButton&&this.userInfoButton.show()},zsSdk.hideUserInfoButton=function(){this.userInfoButton&&this.userInfoButton.hide()},zsSdk.destroyUserInfoButton=function(){this.userInfoButton&&(this.userInfoButton.destroy(),this.userInfoButton=null)},zsSdk.openShare=function(e,n){wx.shareAppMessage({title:e,imageUrl:n})},zsSdk.initVideoAD=function(e){if(null!=e&&""!=e){if(this.rewardedVideoAd=wx.createRewardedVideoAd({adUnitId:e}),null!=this.rewardedVideoAd){var n=this;this.rewardedVideoAd.onError(function(e){console.log(e),n.rewardedVideoAd=null,n.errorHandler&&n.errorHandler.runWith(e)}),this.rewardedVideoAd.onClose(function(e){e&&e.isEnded||void 0===e?n.videoCompletedHandler&&n.videoCompletedHandler.run():n.videoInterruptHandler&&n.videoInterruptHandler.run()})}}else this.rewardedVideoAd=null},zsSdk.isVideoEnable=function(){return null!=this.rewardedVideoAd},zsSdk.playVideo=function(e,n,i){if(null!=this.rewardedVideoAd){this.videoErrorHandler=i,this.videoCompletedHandler=e,this.videoInterruptHandler=n;var t=this;this.rewardedVideoAd.show().catch(function(e){t.rewardedVideoAd.load().then(function(){t.rewardedVideoAd.show()})})}else i&&i.runWith("video disable")},zsSdk.initFullScreenAD=function(e,n){var i=wx.getSystemInfoSync();i.SDKVersion<="2.6.0"?n&&n.runWith(i.SDKVersion+" <= 2.6.0"):this.fullScreenADUnitId=e},zsSdk.loadFullScreenAD=function(e,n){if(null!=this.fullScreenADUnitId&&(this.fullScreenAD=wx.createInterstitialAd({adUnitId:this.fullScreenADUnitId}),null!=this.fullScreenAD)){var i=this;this.fullScreenAD.onLoad(function(){e&&e.run()}),this.fullScreenAD.onError(function(e){console.log(e),i.fullScreenAD=null,n&&n.runWith(e)})}},zsSdk.showFullScreenAD=function(e){if(null!=this.fullScreenAD){var n=this;this.fullScreenAD.onClose(function(){n.fullScreenAD=null,e&&e.runWith(err)}),this.fullScreenAD.show()}},zsSdk.setUserCloudStorage=function(e,n,i,t){wx.setUserCloudStorage({KVDataList:e,success:function(e){console.log("-----success:"+JSON.stringify(e)),n&&n.runWith(e)},fail:function(e){console.log("-----fail:"+JSON.stringify(e)),i&&i.runWith(e)},complete:function(e){console.log("-----complete:"+JSON.stringify(e)),t&&t.runWith(e)}})},zsSdk.playSound=function(e,n,i){var t=null;let o=this;if(this.srcIdxObj[e]&&(t=this.audioArr[this.srcIdxObj[e].idx],console.debug("取到"+e+"的音频"),!this.srcIdxObj[e].isStop))return console.debug(e+"已在播放中"),void(o.continiu=!0);t||(t=wx.createInnerAudioContext(),this.audioArr.push(t),t.onError(function(e){console.debug("音效播放异常  code "+JSON.stringify(e)),o.audioArr.splice(o.srcIdxObj[t.src].idx),delete o.srcIdxObj[t.src],t.destroy()})),t.src=e,t.loop=n,this.srcIdxObj[e]={idx:this.audioArr.indexOf(t),ptime:(new Date).getTime(),isStop:!1,curTime:0},t.onEnded(function(){i&&i.run()}),t.play()},zsSdk.pauseSound=function(e){var n=this.audioArr[this.srcIdxObj[e].idx];n&&(n.pause(),n.offEnded())},zsSdk.stopSound=function(e){if(this.srcIdxObj[e]){this.continiu=!1;var n=(new Date).getTime()-this.srcIdxObj[e].ptime;if(n<300){console.debug("间隔过短，延时关闭");let i=this;setTimeout(function(){if(i.srcIdxObj[e]){var n=i.audioArr[i.srcIdxObj[e].idx];!n||i.srcIdxObj[e].isStop||i.continiu||(i.srcIdxObj[e].isStop=!0,n.stop(),n.offEnded(),console.debug("进入延时关闭"))}},300-n)}else{var i=this.audioArr[this.srcIdxObj[e].idx];i.stop(),i.offEnded(),this.srcIdxObj[e].isStop=!0,console.debug("进入关闭")}}},zsSdk}(),window.zsDevice=function(){function zsDevice(){}return zsDevice.deviceInfo=null,zsDevice.init=function(){this.deviceInfo=wx.getSystemInfoSync(),console.log(this.deviceInfo),console.log("zsDevice.init")},zsDevice.onShow=function(e){wx.onShow(function(n){console.log("zsDevice.show:"+Date.now()),e&&e.runWith(n)})},zsDevice.onHide=function(e){wx.onHide(function(){console.log("zsDevice.hide:"+Date.now()),e&&e.run()})},zsDevice.vibrateShort=function(){wx.vibrateShort({fail:function(){console.log("vibrateShort failed")}})},zsDevice.vibrateLong=function(){wx.vibrateLong({fail:function(){console.log("vibrateShort failed")}})},zsDevice.isNetValid=function(){return!0},zsDevice.statusBarHeight=function(){return this.deviceInfo?this.deviceInfo.statusBarHeight:0},zsDevice.screenWidth=function(){return this.deviceInfo?this.deviceInfo.screenWidth:1},zsDevice.screenHeight=function(){return this.deviceInfo?this.deviceInfo.screenHeight:1},zsDevice}();