window.fc=window.fc||{},window.fc.adapter=window.fc.adapter||{},function(e,n){"use strict";window.wx=window.tt,window.zsSdk=function(){function zsSdk(){}return zsSdk.rewardedVideoAd=null,zsSdk.videoCompletedHandler=null,zsSdk.videoInterruptHandler=null,zsSdk.videoErrorHandler=null,zsSdk.bannerAd=null,zsSdk.bannerAdUnitId=null,zsSdk.bannerType="pixel",zsSdk.fullScreenAD=null,zsSdk.fullScreenADUnitId=null,zsSdk.userInfoButton=null,zsSdk.bannerAdScale=.9,zsSdk.bannerLiveTime=0,zsSdk.bannerLastShowTime=0,zsSdk.recorderTime=0,zsSdk.recording=!1,zsSdk.videoPath="",zsSdk.bannerStyle={width:300,height:125},zsSdk.videoAdUnitId="",zsSdk.init=function(){tt.showShareMenu({withShareTicket:!0}),tt.onShow(function(e){console.log("游戏回到前台",e),console.log(e.query,e.referrerInfo,e.scene);e.scene&&-1!=["011004","021001","061004"].indexOf(e.scene)&&(console.log("从我的小程序进来的"),n.stage.event(zs.laya.platform.PlatformMgr.ADD_MY_MINI_PROGRAM))}),window.zsResUrl&&(n.URL.basePath=window.zsResUrl,n.MiniAdpter.nativefiles=window.zsNativefiles),n.MiniAdpter&&n.MiniAdpter.getUrlEncode&&(n.MiniAdpter.getUrlEncode=function(e,n){return-1!=e.indexOf(".fnt")||-1!=e.indexOf(".json")?"utf8":"arraybuffer"==n?"":"ascii"}),console.log("zsSdk.init")},zsSdk.login=function(e,n){if(!window.tt)return console.log("=====tt不存在"),void(n&&n.runWith("Code不存在"));tt.login({force:!1,success:function(t){console.log("res====",t),t.code||t.anonymousCode?e&&e.runWith({identityId:t.code||"",anonymous_code:t.anonymousCode}):n&&n.runWith("Code不存在")},fail:function(){n&&n.runWith("登陆失败")},complete:function(){}})},zsSdk.createUserInfoButton=function(e,n){},zsSdk.showUserInfoButton=function(){this.userInfoButton&&this.userInfoButton.show()},zsSdk.hideUserInfoButton=function(){this.userInfoButton&&this.userInfoButton.hide()},zsSdk.destroyUserInfoButton=function(){this.userInfoButton&&(this.userInfoButton.destroy(),this.userInfoButton=null)},zsSdk.openShare=function(e,n,t){tt.shareAppMessage({title:e,imageUrl:n,desc:t})},zsSdk.initVideoAD=function(e){if(window.tt&&"function"==typeof window.tt.createRewardedVideoAd&&e&&""!=e&&(this.videoAdUnitId=e,this.rewardedVideoAd=tt.createRewardedVideoAd({adUnitId:e}),null!=this.rewardedVideoAd)){var n=this;this.rewardedVideoAd.onError(function(e){console.log(e),n.rewardedVideoAd=null,n.videoErrorHandler&&n.videoErrorHandler.runWith(e)}),this.rewardedVideoAd.onClose(function(e){e&&e.isEnded||void 0===e?n.videoCompletedHandler&&(console.log("奖励发放成功"),n.videoCompletedHandler.run()):n.videoInterruptHandler&&n.videoInterruptHandler.run()})}},zsSdk.isVideoEnable=function(){return null!=this.rewardedVideoAd},zsSdk.playVideo=function(e,n,t){if(null==this.rewardedVideoAd)return t&&t.runWith("video disable"),void this.initVideoAD(this.videoAdUnitId);this.videoErrorHandler=t,this.videoCompletedHandler=e,this.videoInterruptHandler=n;var i=this;this.rewardedVideoAd.show().then(()=>{console.log("广告显示成功")}).catch(e=>{console.log("广告组件出现问题",e),i.rewardedVideoAd.load().then(()=>(console.log("手动加载成功"),i.rewardedVideoAd.show()))})},zsSdk.initBannerAD=function(e,n,t,i){if(window.tt&&"function"==typeof window.tt.createBannerAd&&e&&""!=e){this.bannerAdUnitId=e,this.bannerAdScale=n,this.bannerLiveTime=t,this.bannerLastShowTime=0;var o=.5*(1-this.bannerAdScale),r=tt.getSystemInfoSync();if(this.bannerAd=tt.createBannerAd({adUnitId:e,adIntervals:30,style:{top:r.windowHeight-100,width:r.windowWidth*zsSdk.bannerAdScale,left:r.windowWidth*o}}),null!=this.bannerAd){this.bannerAd.onResize(function(e){if(zsSdk.bannerStyle=e,zsSdk.bannerAd)if("pixel"==zsSdk.bannerType){zsSdk.bannerAd.style.top=window.screen.availHeight-1,zsSdk.bannerAd.style.left=1-zsSdk.bannerStyle.width}else zsSdk.bannerAd.style.top=window.screen.availHeight-e.height-3,zsSdk.bannerAd.style.left=.5*(window.screen.availWidth-e.width)});var d=this;this.bannerAd.onError(function(e){console.log(e),d.bannerAd=null,i&&i.run()})}}},zsSdk.showBanner=function(e){null!=this.bannerAdUnitId&&(this.bannerType="normal",null==this.bannerAd&&this.initBannerAD(this.bannerAdUnitId,this.bannerAdScale,this.bannerLiveTime,e),this.bannerAd&&(this.bannerAd.style.top=window.screen.availHeight-zsSdk.bannerStyle.height-3,this.bannerAd.style.left=.5*(window.screen.availWidth-zsSdk.bannerStyle.width),this.bannerAd.show()),this.bannerLastShowTime=Date.now())},zsSdk.showBannerByOnePixel=function(e){if(null!=this.bannerAdUnitId){this.bannerType="pixel",null==this.bannerAd&&this.initBannerAD(this.bannerAdUnitId,this.bannerAdScale,this.bannerLiveTime,e);this.bannerAd&&(this.bannerAd.style.top=window.screen.availHeight-1,this.bannerAd.style.left=1-zsSdk.bannerStyle.width,this.bannerAd.show()),this.bannerLastShowTime=Date.now()}},zsSdk.hideBanner=function(){this.bannerAd&&(this.bannerAd.hide(),this.bannerLastShowTime>0&&Date.now()-this.bannerLastShowTime>this.bannerLiveTime&&(this.bannerAd.destroy(),this.bannerAd=null,this.initBannerAD(this.bannerAdUnitId,this.bannerAdScale,this.bannerLiveTime)))},zsSdk.initFullScreenAD=function(e,t){"Toutiao"===tt.getSystemInfoSync().appName&&n.Browser.onAndroid?this.fullScreenADUnitId=e:t&&t.runWith(tt.getSystemInfoSync().appName+"'s app can't support insertAd")},zsSdk.loadFullScreenAD=function(e,n){if(null!=this.fullScreenADUnitId&&window.tt&&"function"==typeof window.tt.createInterstitialAd&&(this.fullScreenAD=tt.createInterstitialAd({adUnitId:this.fullScreenADUnitId}),null!=this.fullScreenAD)){var t=this;this.fullScreenAD.onLoad(function(){e&&e.run()}),this.fullScreenAD.onError(function(e){console.log(e),t.fullScreenAD=null,n&&n.runWith(e)})}},zsSdk.showFullScreenAD=function(e){if(null!=this.fullScreenAD){var n=this;this.fullScreenAD.onClose(function(){n.fullScreenAD=null,e&&e.runWith()}),this.fullScreenAD.show()}},zsSdk.setUserCloudStorage=function(e,n,t,i){},zsSdk.startRecorder=function(e){if(window.tt&&(e=e||zs.laya.platform.ADConfig.zs_best_videotape_time,"function"==typeof window.tt.getGameRecorderManager)){const t=window.tt.getGameRecorderManager();var n=this;t.onStart(e=>{n.recording=!0,n.recorderTime=Date.now()}),t.onStop(e=>{n.recording=!1,n.videoPath=e.videoPath,n.recorderTime=Date.now()-n.recorderTime;var i=zs.laya.platform.ADConfig.zs_last_video_time;i>0&&t.clipVideo({path:e.videoPath,timeRange:[i,0],success(e){console.log("剪辑最后视频成功"),n.videoPath=e.videoPath},fail(e){console.error("剪辑视频失败")}})}),t.start({duration:e})}},zsSdk.stopRecorder=function(){if(window.tt&&this.recording&&"function"==typeof window.tt.getGameRecorderManager){window.tt.getGameRecorderManager().stop()}},zsSdk.pauseRecorder=function(){if(window.tt&&this.recording&&"function"==typeof window.tt.getGameRecorderManager){window.tt.getGameRecorderManager().pause()}},zsSdk.resumeRecorder=function(){if(window.tt&&this.recording&&"function"==typeof window.tt.getGameRecorderManager){window.tt.getGameRecorderManager().resume()}},zsSdk.shareRecorderVideo=function(e){if(!window.tt||""==this.videoPath)return void e(!1);var n=zs.laya.platform.ADConfig.zs_share_topics,t=[];""!=n&&(t=n.split(","));let i={channel:"video",desc:zs.laya.platform.ADConfig.zs_share_desc,title:zs.laya.platform.ADConfig.zs_share_title,imageUrl:zs.laya.platform.ADConfig.zs_share_image,query:"",extra:{videoPath:this.videoPath,videoTopics:t},success(){e(!0)},fail(n){e(!1)}};console.log("分享录屏",i),tt.shareAppMessage(i)},zsSdk.shareAppMessage=function(e){window.tt||e(!1);let n={success(){e(!0)},fail(n){e(!1)}};tt.shareAppMessage(n)},zsSdk.canShareRecorder=function(){return this.recorderTime/1e3>=5},zsSdk.showMoreGamesModalSimple=function(e,n){if(!window.tt||"function"!=typeof window.tt.showMoreGamesModal)return;tt.offNavigateToMiniProgram(),tt.offMoreGamesModalClose(),tt.onMoreGamesModalClose(function(e){console.log("modal closed",e)}),tt.onNavigateToMiniProgram(function(t){t&&(console.log("是否有跳转的小游戏",t),0==t.errCode?isFun(e)&&e():isFun(n)&&n())});const t=tt.getSystemInfoSync();var i={};i.appId=window.zs.wx.appId,"ios"!==t.platform&&tt.showMoreGamesModal({appLaunchOptions:[{extraData:i}],success(e){console.log("showMoreGamesModal success",e.errMsg)},fail(e){console.log("showMoreGamesModal fail",e.errMsg)}})},zsSdk.isIOS=function(){return n.Browser.onIOS},zsSdk}(),window.zsDevice=function(){function zsDevice(){}return zsDevice.deviceInfo=null,zsDevice.init=function(){window.tt&&(this.deviceInfo=tt.getSystemInfoSync(),console.log(this.deviceInfo),console.log("zsDevice.init"))},zsDevice.onShow=function(e){window.tt&&tt.onShow(function(n){console.log("zsDevice.show:"+Date.now()),e&&e.runWith(n)})},zsDevice.onHide=function(e){window.tt&&tt.onHide(function(){console.log("zsDevice.hide:"+Date.now()),e&&e.run()})},zsDevice.vibrateShort=function(){window.tt&&tt.vibrateShort({fail:function(){console.log("vibrateShort failed")}})},zsDevice.vibrateLong=function(){window.tt&&tt.vibrateLong({fail:function(){console.log("vibrateShort failed")}})},zsDevice.isNetValid=function(){return!0},zsDevice.statusBarHeight=function(){if(this.deviceInfo&&this.deviceInfo.model){if(-1!=this.deviceInfo.model.toLowerCase().replace(/\s*/g,"").indexOf("iphonex"))return 44}return this.deviceInfo?this.deviceInfo.statusBarHeight:0},zsDevice.screenWidth=function(){return this.deviceInfo?this.deviceInfo.screenWidth:1},zsDevice.screenHeight=function(){return this.deviceInfo?this.deviceInfo.screenHeight:1},zsDevice}()}(window.fc.adapter,Laya);