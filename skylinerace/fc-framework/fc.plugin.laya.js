window.fc=window.fc||{},window.fc.plugin=window.fc.plugin||{},function(t,e){"use strict";var i=fc.define.Event,s=fc.define.Layout,n=fc.framework.Resource;class r{static printPoolInfo(){for(var t in console.log("ObjectPool.poolStatus:"+JSON.stringify(this.poolStatus)),this.poolStatus)this.poolStatus.hasOwnProperty(t)&&e.Pool.clearBySign(t);this.poolStatus={}}static recoverSprite3d(t){t.removeSelf(),null!=t._fc_sign&&(t.__InPool||(this.poolStatus[t._fc_sign]||(this.poolStatus[t._fc_sign]={}),this.poolStatus[t._fc_sign].free?this.poolStatus[t._fc_sign].free+=1:this.poolStatus[t._fc_sign].free=1,e.Pool.recover(t._fc_sign,t)))}static getSprite3d(t,i){var s=i||t.url;this.poolStatus[s]?this.poolStatus[s].total+=1:(this.poolStatus[s]={},this.poolStatus[s].total=1);var n=this;return e.Pool.getItemByCreateFun(s,function(){return n.createSprite3d(t,s)})}static createSprite3d(t,i){var s=e.Sprite3D.instantiate(t,null,!1,e.Vector3._ZERO.clone());return s._fc_sign=i,s}static getEmptySprite3d(t){var i=t;this.poolStatus[i]?this.poolStatus[i].total+=1:(this.poolStatus[i]={},this.poolStatus[i].total=1);var s=this;return e.Pool.getItemByCreateFun(i,function(){return s.createEmptySprite3d(t)})}static createEmptySprite3d(t){var i=new e.Sprite3D;return i._fc_sign=t,i}}r.poolStatus={},e.ILaya.regClass(r),e.ClassUtils.regClass("fc.plugin.ObjectPool",r);class a extends e.Script{initView(t){}constructor(){super(),this.active=!1,this.topUI=null,this.middleUI=null,this.bottomUI=null,this.leftFloatUI=null,this.rightFloatUI=null,this.fullUI=null,this.applyStatusBar=!0,this.isFull=!0,this.vLayout=s.VERTICAL_MIDDLE,this.hLayout=s.HORIZONTAL_CENTER,this.viewName=""}applyLayout(){var t=this.owner;this.isFull?(t.top=0,t.bottom=0,t.left=0,t.right=0):(0==this.vLayout?t.top=0:1==this.vLayout?t.centerY=0:t.bottom=0,0==this.hLayout?t.left=0:1==this.hLayout?t.centerX=0:t.right=0),this.topUI&&(this.topUI.top=0,this.topUI.centerX=0),this.middleUI&&(this.middleUI.centerY=0,this.middleUI.centerX=0),this.bottomUI&&(this.bottomUI.bottom=0,this.bottomUI.centerX=0),this.leftFloatUI&&(this.leftFloatUI.left=0,this.leftFloatUI.centerY=0),this.rightFloatUI&&(this.rightFloatUI.left=e.stage.width,this.rightFloatUI.centerY=0),this.fullUI&&(this.fullUI.top=-10,this.fullUI.bottom=-10,this.fullUI.left=-10,this.fullUI.right=-10)}onAwake(){this.topUI=this.owner.getChildByName("topUI"),this.middleUI=this.owner.getChildByName("middleUI"),this.bottomUI=this.owner.getChildByName("bottomUI"),this.leftFloatUI=this.owner.getChildByName("leftFloatUI"),this.rightFloatUI=this.owner.getChildByName("rightFloatUI"),this.fullUI=this.owner.getChildByName("fullUI"),this.viewName=this.owner.url,this.viewName=this.viewName.substring(this.viewName.lastIndexOf("/")+1,this.viewName.lastIndexOf("."))}onEnable(){this.applyLayout(),e.stage.event(i.UI_VIEW_OPENED,[this.viewName,this.owner])}onDisable(){e.stage.event(i.UI_VIEW_CLOSED,[this.viewName,this.owner])}}e.ILaya.regClass(a),e.ClassUtils.regClass("fc.plugin.BaseView",a);class l extends e.Script3D{static createEffect(t){null!=t&&(t.createTime=e.timer.currTimer,this.effectWaitingList.push(t),1==this.effectWaitingList.length&&this.instanceEffectDelay(2))}static instanceEffectDelay(t){e.timer.frameOnce(t,this,this.instanceEffect,[t])}static instanceEffect(t){var i=this.effectWaitingList.shift();e.timer.currTimer-i.createTime>i.duaration?this.effectWaitingList.length>0&&this.instanceEffectDelay(t):(n.LoadSpriteAsyn(i.sign,e.Handler.create(this,this.onEffectReady,[i])),this.effectWaitingList.length>0&&this.instanceEffectDelay(t))}static onEffectReady(t,i){if(!(e.timer.currTimer-t.createTime>t.duaration)){var s=r.GetSprite3d(i);if(null!=s&&!t.parent.destroyed&&null!=t.parent.parent){t.parent.addChild(s),s.name=t.customId,null==t.isWorldSpace||(t.isWorldSpace?(!t.position||(s.transform.position=t.position),!t.rotation||(s.transform.rotation=t.rotation)):(!t.position||(s.transform.localPosition=t.position),!t.rotation||(s.transform.localRotation=t.rotation)));var n=s.getComponent(l);null==n&&(n=s.addComponent(l)),n.delay=t.duaration}}}constructor(){super(),this.delay=Number.MAX_VALUE}cleanNode(){r.RecoverSprite3d(this.owner)}onUpdate(){this.delay<0||(this.delay-=e.timer.delta,this.delay<=0&&(this.delay=Number.MAX_VALUE,r.RecoverSprite3d(this.owner)))}onDestroy(){this.delay=null}}l.effectWaitingList=[],e.ILaya.regClass(l),e.ClassUtils.regClass("fc.plugin.Effect3d",l);class o extends e.Script3D{constructor(){super(),this.listener=null}static Init(t,e){var i=t.getComponent(o);i||(i=t.addComponent(o)),i.listener=e,i.listener==i&&console.warn("Trigger3dListener","listener can't be self")}onTriggerEnter(t,e,i){this.listener!=this&&null!=this.listener&&this.listener.on3dTriggerEnter&&this.listener.on3dTriggerEnter(t,e,i)}onTriggerExit(t,e,i){this.listener!=this&&null!=this.listener&&this.listener.on3dTriggerEnter&&this.listener.on3dTriggerEnter(t,e,i)}onTriggerStay(t,e,i){this.listener!=this&&null!=this.listener&&this.listener.on3dTriggerStay&&this.listener.on3dTriggerStay(t,e,i)}onDestroy(){this.listener=null}}e.ILaya.regClass(o),e.ClassUtils.regClass("fc.plugin.Trigger3dListener",o);class h extends e.Script3D{static init(t,e){var i=t.owner.getComponent(h);null==i&&(i=t.owner.addComponent(h)),i.listener=e}constructor(){super(),this.listener=null}onAnimEvt(...t){this.listener&&this.mListener.onAnimEvt&&this.listener.onAnimEvt(...t)}}e.ILaya.regClass(h),e.ClassUtils.regClass("fc.plugin.AnimEventListener",h);class c extends e.AnimatorStateScript{constructor(){super(),this.stateName="",this.animator=null,this.listener=null}static init(t,e,i){var s=t.getControllerLayer(0).getAnimatorState(e);if(null!=s){var n=s.getScript(c);null==n&&(n=s.addScript(c)),n.stateName=e,n.animator=t,n.listener=i}}static remove(t,e){var i=t.getControllerLayer(0).getAnimatorState(e);if(null!=i){var s=i.getScript(c);null!=s&&(s.stateName=null,s.animator=null,s.listener=null)}}onStateEnter(){this.listener&&this.listener.onAnimStateEnter&&this.listener.onAnimStateEnter(this.stateName,this.animator)}onStateUpdate(){this.listener&&this.listener.onAnimStateUpdate&&this.listener.onAnimStateUpdate(this.stateName,this.animator)}onStateExit(){this.listener&&this.listener.onAnimStateExit&&this.listener.onAnimStateExit(this.stateName,this.animator)}}e.ILaya.regClass(c),e.ClassUtils.regClass("fc.plugin.AnimStateListener",c),t.ObjectPool=r,t.BaseView=a,t.Effect3d=l,t.Trigger3dListener=o,t.AnimEventListener=h,t.AnimStateListener=c}(window.fc.plugin,Laya);